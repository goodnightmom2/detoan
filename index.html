<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đề Thi Toán 11 HK1 - Đề Số 6 (Ma trận 2025)</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --primary: #004d40; /* Xanh rêu đậm */
            --secondary: #00796b;
            --light: #e0f2f1;
            --correct: #c8e6c9;
            --wrong: #ffcdd2;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.5;
            margin: 0;
            padding: 20px;
        }

        .exam-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .exam-header {
            text-align: center;
            border-bottom: 3px double var(--primary);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .exam-header h1 {
            color: var(--primary);
            margin: 0 0 10px 0;
            text-transform: uppercase;
        }

        .section-title {
            background-color: var(--primary);
            color: white;
            padding: 10px 15px;
            border-radius: 6px;
            margin-top: 40px;
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 1.1em;
        }

        /* Question Box Styles */
        .question-box {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .q-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #263238;
        }

        /* Multiple Choice Styles */
        .mc-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .mc-label {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 4px;
            cursor: pointer;
            transition: 0.2s;
        }

        .mc-label:hover {
            background-color: var(--light);
        }

        .mc-label input {
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* True/False Table Styles */
        .tf-table {
            width: 100%;
            border-collapse: collapse;
        }

        .tf-table th, .tf-table td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
        }

        .tf-table th {
            background-color: #eceff1;
            text-align: center;
        }

        .tf-radio {
            text-align: center;
            width: 60px;
        }

        /* Short Answer Styles */
        .short-ans-input {
            width: 100%;
            max-width: 250px;
            padding: 8px 12px;
            border: 2px solid #bdbdbd;
            border-radius: 4px;
            font-size: 16px;
        }

        /* Result & Feedback */
        .btn-submit {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
        }

        .btn-submit:hover {
            background-color: var(--primary);
        }

        .feedback-msg {
            margin-top: 8px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .box-correct { background-color: var(--correct); border-color: #81c784; }
        .box-wrong { background-color: var(--wrong); border-color: #e57373; }

        .result-panel {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f5e9;
            border: 2px solid #2e7d32;
            border-radius: 8px;
            text-align: center;
            font-size: 1.5em;
            color: #2e7d32;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="exam-container">
    <div class="exam-header">
        <h1>ĐỀ KIỂM TRA TOÁN 11 (ĐỀ SỐ 6)</h1>
        <p>Thời gian: 60 phút | Bám sát Ma trận 2025</p>
    </div>

    <form id="examForm">

        <div class="section-title">PHẦN I. TRẮC NGHIỆM (3.0 điểm - 0.25đ/câu)</div>

        <div class="question-box" id="q1">
            <div class="q-title">Câu 1: Cho cấp số nhân \( (u_n) \) có \( u_1 = 3 \) và \( u_2 = 12 \). Công bội \( q \) bằng:</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q1" value="A"> A. \( q = 4 \)</label>
                <label class="mc-label"><input type="radio" name="p1_q1" value="B"> B. \( q = 9 \)</label>
                <label class="mc-label"><input type="radio" name="p1_q1" value="C"> C. \( q = 3 \)</label>
                <label class="mc-label"><input type="radio" name="p1_q1" value="D"> D. \( q = \frac{1}{4} \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q2">
            <div class="q-title">Câu 2: Số hạng tổng quát của cấp số nhân \( 2; 4; 8; 16; ... \) là:</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q2" value="A"> A. \( u_n = 2^n \)</label>
                <label class="mc-label"><input type="radio" name="p1_q2" value="B"> B. \( u_n = 2n \)</label>
                <label class="mc-label"><input type="radio" name="p1_q2" value="C"> C. \( u_n = 2^{n-1} \)</label>
                <label class="mc-label"><input type="radio" name="p1_q2" value="D"> D. \( u_n = n+2 \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q3">
            <div class="q-title">Câu 3: Kết quả của \( \lim \left( 5 + \frac{1}{n} \right) \) là:</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q3" value="A"> A. 5</label>
                <label class="mc-label"><input type="radio" name="p1_q3" value="B"> B. 6</label>
                <label class="mc-label"><input type="radio" name="p1_q3" value="C"> C. 0</label>
                <label class="mc-label"><input type="radio" name="p1_q3" value="D"> D. \( +\infty \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q4">
            <div class="q-title">Câu 4: Tính giới hạn \( L = \lim_{x \to 1} (x^2 - 4x + 1) \).</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q4" value="A"> A. -2</label>
                <label class="mc-label"><input type="radio" name="p1_q4" value="B"> B. 1</label>
                <label class="mc-label"><input type="radio" name="p1_q4" value="C"> C. -4</label>
                <label class="mc-label"><input type="radio" name="p1_q4" value="D"> D. 2</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q5">
            <div class="q-title">Câu 5: Giới hạn \( \lim_{x \to +\infty} \frac{3x^2 - x}{x^2 + 5} \) bằng:</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q5" value="A"> A. 3</label>
                <label class="mc-label"><input type="radio" name="p1_q5" value="B"> B. -1</label>
                <label class="mc-label"><input type="radio" name="p1_q5" value="C"> C. 0</label>
                <label class="mc-label"><input type="radio" name="p1_q5" value="D"> D. \( +\infty \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q6">
            <div class="q-title">Câu 6: Tính \( \lim_{x \to 3} \frac{x^2 - 9}{x - 3} \).</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q6" value="A"> A. 6</label>
                <label class="mc-label"><input type="radio" name="p1_q6" value="B"> B. 0</label>
                <label class="mc-label"><input type="radio" name="p1_q6" value="C"> C. 3</label>
                <label class="mc-label"><input type="radio" name="p1_q6" value="D"> D. \( \infty \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q7">
            <div class="q-title">Câu 7: Hàm số \( y = \frac{2x}{x+1} \) liên tục trên khoảng nào sau đây?</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q7" value="A"> A. \( (-1; +\infty) \)</label>
                <label class="mc-label"><input type="radio" name="p1_q7" value="B"> B. \( (-\infty; 0) \)</label>
                <label class="mc-label"><input type="radio" name="p1_q7" value="C"> C. \( \mathbb{R} \)</label>
                <label class="mc-label"><input type="radio" name="p1_q7" value="D"> D. \( (-3; 3) \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q8">
            <div class="q-title">Câu 8: Cho mẫu số liệu ghép nhóm về thời gian tự học (phút): [0;20), [20;40), [40;60). Tần số tương ứng là 5, 12, 3. Nhóm chứa mốt là:</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q8" value="A"> A. [20; 40)</label>
                <label class="mc-label"><input type="radio" name="p1_q8" value="B"> B. [0; 20)</label>
                <label class="mc-label"><input type="radio" name="p1_q8" value="C"> C. [40; 60)</label>
                <label class="mc-label"><input type="radio" name="p1_q8" value="D"> D. Không xác định</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q9">
            <div class="q-title">Câu 9: Cho đường thẳng \( d \) và mặt phẳng \( (\alpha) \). Nếu \( d \) song song với \( (\alpha) \) thì:</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q9" value="A"> A. Chúng không có điểm chung</label>
                <label class="mc-label"><input type="radio" name="p1_q9" value="B"> B. \( d \) nằm trong \( (\alpha) \)</label>
                <label class="mc-label"><input type="radio" name="p1_q9" value="C"> C. Chúng cắt nhau</label>
                <label class="mc-label"><input type="radio" name="p1_q9" value="D"> D. Có vô số điểm chung</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q10">
            <div class="q-title">Câu 10: Cho tứ diện \( ABCD \). Gọi \( I, J \) là trung điểm của \( AB \) và \( AC \). Đường thẳng \( IJ \) song song với mặt phẳng nào?</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q10" value="A"> A. \( (BCD) \)</label>
                <label class="mc-label"><input type="radio" name="p1_q10" value="B"> B. \( (ABD) \)</label>
                <label class="mc-label"><input type="radio" name="p1_q10" value="C"> C. \( (ACD) \)</label>
                <label class="mc-label"><input type="radio" name="p1_q10" value="D"> D. \( (ABC) \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q11">
            <div class="q-title">Câu 11: Trong không gian, qua một điểm nằm ngoài mặt phẳng cho trước, ta vẽ được bao nhiêu mặt phẳng song song với mặt phẳng đó?</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q11" value="A"> A. Duy nhất 1</label>
                <label class="mc-label"><input type="radio" name="p1_q11" value="B"> B. 2</label>
                <label class="mc-label"><input type="radio" name="p1_q11" value="C"> C. Vô số</label>
                <label class="mc-label"><input type="radio" name="p1_q11" value="D"> D. 0</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="q12">
            <div class="q-title">Câu 12: Cho lăng trụ \( ABC.A'B'C' \). Khẳng định nào SAI?</div>
            <div class="mc-options">
                <label class="mc-label"><input type="radio" name="p1_q12" value="A"> A. \( (ABB'A') // (ACC'A') \)</label>
                <label class="mc-label"><input type="radio" name="p1_q12" value="B"> B. \( (ABC) // (A'B'C') \)</label>
                <label class="mc-label"><input type="radio" name="p1_q12" value="C"> C. \( AA' // BB' \)</label>
                <label class="mc-label"><input type="radio" name="p1_q12" value="D"> D. \( AB // A'B' \)</label>
            </div>
            <div class="feedback-msg"></div>
        </div>

        <div class="section-title">PHẦN II. ĐÚNG/SAI (4.0 điểm - Thang điểm 0.1/0.25/0.5/1.0)</div>

        <div class="question-box" id="p2_q1">
            <div class="q-title">Câu 1: Một người gửi tiết kiệm 100 triệu đồng vào ngân hàng với lãi suất 6%/năm theo hình thức lãi kép (tiền lãi nhập vào vốn). Gọi \( u_n \) là số tiền người đó có được sau \( n \) năm.</div>
            <table class="tf-table">
                <tr><th>Ý</th><th>Nội dung</th><th>Đúng</th><th>Sai</th></tr>
                <tr>
                    <td>a</td><td>Dãy số \( (u_n) \) là một cấp số nhân.</td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_a" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_a" value="false"></td>
                </tr>
                <tr>
                    <td>b</td><td>Công bội của cấp số nhân là \( q = 0.06 \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_b" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_b" value="false"></td>
                </tr>
                <tr>
                    <td>c</td><td>Số tiền sau 1 năm là 106 triệu đồng.</td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_c" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_c" value="false"></td>
                </tr>
                <tr>
                    <td>d</td><td>Sau 10 năm, số tiền nhận được xấp xỉ 179 triệu đồng.</td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_d" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q1_d" value="false"></td>
                </tr>
            </table>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p2_q2">
            <div class="q-title">Câu 2: Cho hàm số \( f(x) = \begin{cases} \frac{x^2-1}{x-1} & \text{khi } x \neq 1 \\ 3 & \text{khi } x = 1 \end{cases} \).</div>
            <table class="tf-table">
                <tr><th>Ý</th><th>Nội dung</th><th>Đúng</th><th>Sai</th></tr>
                <tr>
                    <td>a</td><td>Tập xác định của hàm số là \( \mathbb{R} \setminus \{1\} \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_a" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_a" value="false"></td>
                </tr>
                <tr>
                    <td>b</td><td>\( \lim_{x \to 1} f(x) = 2 \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_b" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_b" value="false"></td>
                </tr>
                <tr>
                    <td>c</td><td>Giá trị của hàm số tại \( x=1 \) là \( f(1) = 3 \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_c" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_c" value="false"></td>
                </tr>
                <tr>
                    <td>d</td><td>Hàm số liên tục tại điểm \( x=1 \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_d" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q2_d" value="false"></td>
                </tr>
            </table>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p2_q3">
            <div class="q-title">Câu 3: Cho hình chóp \( S.ABCD \) có đáy \( ABCD \) là hình bình hành. Gọi \( O \) là giao điểm của hai đường chéo \( AC \) và \( BD \).</div>
            <table class="tf-table">
                <tr><th>Ý</th><th>Nội dung</th><th>Đúng</th><th>Sai</th></tr>
                <tr>
                    <td>a</td><td>Giao tuyến của \( (SAC) \) và \( (SBD) \) là \( SO \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_a" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_a" value="false"></td>
                </tr>
                <tr>
                    <td>b</td><td>Đường thẳng \( AB \) song song với mặt phẳng \( (SCD) \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_b" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_b" value="false"></td>
                </tr>
                <tr>
                    <td>c</td><td>Mặt phẳng \( (SAB) \) song song với mặt phẳng \( (SCD) \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_c" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_c" value="false"></td>
                </tr>
                <tr>
                    <td>d</td><td>Một mặt phẳng \( (\alpha) \) qua \( O \) song song với \( (SAB) \) sẽ cắt \( SC \) tại trung điểm của \( SC \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_d" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q3_d" value="false"></td>
                </tr>
            </table>
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p2_q4">
            <div class="q-title">Câu 4: Cho hình hộp chữ nhật \( ABCD.A'B'C'D' \).</div>
            <table class="tf-table">
                <tr><th>Ý</th><th>Nội dung</th><th>Đúng</th><th>Sai</th></tr>
                <tr>
                    <td>a</td><td>Mặt phẳng \( (ADD'A') \) song song với \( (BCC'B') \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_a" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_a" value="false"></td>
                </tr>
                <tr>
                    <td>b</td><td>Đường thẳng \( AC' \) cắt mặt phẳng \( (A'B'C'D') \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_b" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_b" value="false"></td>
                </tr>
                <tr>
                    <td>c</td><td>Hai đường thẳng \( AB \) và \( C'D' \) chéo nhau.</td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_c" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_c" value="false"></td>
                </tr>
                <tr>
                    <td>d</td><td>Mặt phẳng \( (AB'D') \) song song với mặt phẳng \( (BDC') \).</td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_d" value="true"></td>
                    <td class="tf-radio"><input type="radio" name="p2_q4_d" value="false"></td>
                </tr>
            </table>
            <div class="feedback-msg"></div>
        </div>

        <div class="section-title">PHẦN III. TRẢ LỜI NGẮN (3.0 điểm - 0.5đ/câu)</div>

        <div class="question-box" id="p3_q1">
            <div class="q-title">Câu 1: Một quả bóng cao su được thả từ độ cao 10m. Sau mỗi lần chạm đất, quả bóng nảy lên độ cao bằng \( \frac{2}{3} \) độ cao trước đó. Hỏi sau lần chạm đất thứ 3, quả bóng nảy lên độ cao bao nhiêu mét? (Làm tròn đến 1 chữ số thập phân).</div>
            <input type="number" step="0.1" class="short-ans-input" id="inp_p3_q1" placeholder="Nhập đáp án...">
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p3_q2">
            <div class="q-title">Câu 2: Điểm kiểm tra Toán của một nhóm học sinh: [0;5) có 2 bạn, [5;8) có 10 bạn, [8;10] có 8 bạn. Tính điểm trung bình của nhóm học sinh này (Làm tròn 1 chữ số thập phân). Giả sử lấy giá trị đại diện là trung bình cộng hai đầu mút (với nhóm cuối [8;10] lấy 9).</div>
            <input type="number" step="0.1" class="short-ans-input" id="inp_p3_q2" placeholder="Nhập số...">
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p3_q3">
            <div class="q-title">Câu 3: Biết \( \lim_{x \to 2} \frac{x^2 + ax + b}{x - 2} = 6 \). Tính giá trị của \( S = a + b \).</div>
            <input type="number" class="short-ans-input" id="inp_p3_q3" placeholder="Nhập số...">
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p3_q4">
            <div class="q-title">Câu 4: Tìm giá trị của tham số \( m \) để hàm số \( f(x) = \begin{cases} \frac{\sqrt{x+1}-1}{x} & x \ne 0 \\ m & x = 0 \end{cases} \) liên tục tại \( x = 0 \).</div>
            <input type="number" step="0.1" class="short-ans-input" id="inp_p3_q4" placeholder="Nhập số...">
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p3_q5">
            <div class="q-title">Câu 5: Một người cao 1.6m đứng thẳng trên mặt đất phẳng. Vào lúc bóng người đó trên mặt đất dài 0.8m thì bóng của một cột cờ gần đó dài 5m. Tính chiều cao của cột cờ (mét). Các tia nắng song song.</div>
            <input type="number" class="short-ans-input" id="inp_p3_q5" placeholder="Nhập số...">
            <div class="feedback-msg"></div>
        </div>

        <div class="question-box" id="p3_q6">
            <div class="q-title">Câu 6: Cho tứ diện \( ABCD \). Gọi \( G \) là trọng tâm tam giác \( BCD \). Mặt phẳng \( (\alpha) \) qua \( G \) và song song với mặt phẳng \( (ABC) \) cắt các cạnh \( DB, DC, DA \) lần lượt tại \( M, N, P \). Tính tỉ số diện tích \( \frac{S_{DMN}}{S_{DBC}} \).</div>
            <input type="text" class="short-ans-input" id="inp_p3_q6" placeholder="Nhập phân số (vd: 1/2)...">
            <div class="feedback-msg"></div>
        </div>

        <button type="button" class="btn-submit" onclick="gradeExam()">NỘP BÀI VÀ XEM ĐIỂM</button>

        <div class="result-panel" id="resultPanel">
            ĐIỂM SỐ CỦA BẠN: <span id="scoreDisplay">0</span> / 10
        </div>

    </form>
</div>

<script>
    const answerKey = {
        // Phần 1 (A,B,C,D)
        p1: {
            q1: 'A', // q=12/3 = 4
            q2: 'A', // 2^n
            q3: 'A', // 5
            q4: 'A', // 1-4+1 = -2
            q5: 'A', // 3/1 = 3
            q6: 'A', // x+3 -> 6
            q7: 'A', // x != -1
            q8: 'A', // Tan so 12 (nhom 20-40)
            q9: 'A', // Ko diem chung
            q10: 'A', // // BC // (BCD)
            q11: 'A', // Duy nhat 1
            q12: 'A'  // 2 mat ben ke nhau cat nhau, ko song song
        },
        // Phần 2 (True/False)
        p2: {
            q1: { a: true, b: false, c: true, d: true }, // b sai vi q = 1.06, d: 100*1.06^10 ~ 179
            q2: { a: false, b: true, c: true, d: false }, // a sai (x!=1), d sai (2!=3)
            q3: { a: true, b: true, c: false, d: true }, // c sai (cat nhau theo giao tuyen song song AB)
            q4: { a: true, b: true, c: false, d: true } // c sai (song song chu ko cheo), d dung
        },
        // Phần 3 (Short Answer)
        p3: {
            q1: 3.0, // 10 * (2/3)^3 = 10*8/27 = 2.96 -> 3.0
            q2: 7.1, 
            q3: -6, 
            q4: 0.5, 
            q5: 10,
            q6: "4/9"
        }
    };

    function gradeExam() {
        let totalScore = 0;
        let form = document.getElementById('examForm');

        // --- CHẤM PHẦN 1 ---
        for (let i = 1; i <= 12; i++) {
            let qID = `q${i}`;
            let userAns = form.elements[`p1_${qID}`].value;
            let correctAns = answerKey.p1[qID];
            let box = document.getElementById(qID);
            let msg = box.querySelector('.feedback-msg');

            if (userAns === correctAns) {
                totalScore += 0.25;
                box.classList.add('box-correct');
                msg.innerHTML = "✔ Chính xác";
            } else {
                box.classList.add('box-wrong');
                msg.innerHTML = `✘ Sai. Đáp án đúng: ${correctAns}`;
            }
        }

        // --- CHẤM PHẦN 2 ---
        for (let i = 1; i <= 4; i++) {
            let qID = `p2_q${i}`;
            let correctCount = 0;
            let subQuestions = ['a', 'b', 'c', 'd'];
            
            subQuestions.forEach(sub => {
                let userVal = form.elements[`${qID}_${sub}`].value === "true";
                // Check if user selected anything
                let userSelected = form.elements[`${qID}_${sub}`].value !== "";
                
                if (userSelected && userVal === answerKey.p2[qID][sub]) {
                    correctCount++;
                }
            });

            // Tô màu dựa trên số ý đúng
            let box = document.getElementById(qID);
            let msg = box.querySelector('.feedback-msg');
            let points = 0;
            if (correctCount === 1) points = 0.1;
            else if (correctCount === 2) points = 0.25;
            else if (correctCount === 3) points = 0.5;
            else if (correctCount === 4) points = 1.0;

            totalScore += points;
            
            if (correctCount === 4) {
                box.classList.add('box-correct');
                msg.innerHTML = `✔ Xuất sắc! Đúng 4/4 ý (+1.0đ)`;
            } else {
                box.classList.add('box-wrong');
                msg.innerHTML = `Đúng ${correctCount}/4 ý. (+${points}đ). Đáp án: ` + 
                    subQuestions.map(s => `${s}:${answerKey.p2[qID][s]?'Đ':'S'}`).join(', ');
            }
        }

        // --- CHẤM PHẦN 3 ---
        // Helper: so sánh số
        const checkNumber = (user, correct) => Math.abs(parseFloat(user) - correct) < 0.1;

        // Q1
        let u1 = parseFloat(document.getElementById('inp_p3_q1').value);
        let fb1 = document.querySelector('#p3_q1 .feedback-msg');
        if (checkNumber(u1, 3.0)) { totalScore += 0.5; fb1.innerHTML = "✔ Chính xác"; } 
        else { fb1.innerHTML = "✘ Sai. Đáp án: 3.0"; }

        // Q2
        let u2 = parseFloat(document.getElementById('inp_p3_q2').value);
        let fb2 = document.querySelector('#p3_q2 .feedback-msg');
        if (checkNumber(u2, 7.1)) { totalScore += 0.5; fb2.innerHTML = "✔ Chính xác"; } 
        else { fb2.innerHTML = "✘ Sai. Đáp án: 7.1"; }

        // Q3
        let u3 = parseFloat(document.getElementById('inp_p3_q3').value);
        let fb3 = document.querySelector('#p3_q3 .feedback-msg');
        if (checkNumber(u3, -6)) { totalScore += 0.5; fb3.innerHTML = "✔ Chính xác"; } 
        else { fb3.innerHTML = "✘ Sai. Đáp án: -6"; }

        // Q4
        let u4 = parseFloat(document.getElementById('inp_p3_q4').value);
        let fb4 = document.querySelector('#p3_q4 .feedback-msg');
        if (checkNumber(u4, 0.5)) { totalScore += 0.5; fb4.innerHTML = "✔ Chính xác"; } 
        else { fb4.innerHTML = "✘ Sai. Đáp án: 0.5"; }

        // Q5
        let u5 = parseFloat(document.getElementById('inp_p3_q5').value);
        let fb5 = document.querySelector('#p3_q5 .feedback-msg');
        if (checkNumber(u5, 10)) { totalScore += 0.5; fb5.innerHTML = "✔ Chính xác"; } 
        else { fb5.innerHTML = "✘ Sai. Đáp án: 10"; }

        // Q6 (String comparison for fraction)
        let u6 = document.getElementById('inp_p3_q6').value.trim();
        let fb6 = document.querySelector('#p3_q6 .feedback-msg');
        // Chấp nhận 4/9 hoặc 0.44...
        if (u6 === "4/9" || checkNumber(u6, 0.444)) { totalScore += 0.5; fb6.innerHTML = "✔ Chính xác"; } 
        else { fb6.innerHTML = "✘ Sai. Đáp án: 4/9"; }

        // Hiển thị điểm
        document.getElementById('scoreDisplay').innerText = totalScore.toFixed(2);
        document.getElementById('resultPanel').style.display = 'block';
        document.querySelector('.btn-submit').disabled = true;
        document.querySelector('.btn-submit').innerText = "ĐÃ CHẤM BÀI";
        
        // Scroll to result
        document.getElementById('resultPanel').scrollIntoView({ behavior: 'smooth' });
    }
</script>

</body>
</html>
